#!/usr/bin/python
from util.LogUtils import getModuleLogger
from util.VxUtils import produceVXReport
import os
import time

reportFolder = 'reports'
logging = getModuleLogger(__name__)
    
def writeReport(report):
    if not os.path.exists(reportFolder):
        os.makedirs(reportFolder)

    fileName = "report_{0}.html".format(time.strftime("%d%m%Y-%H%M%S"))
    filePath = os.path.join(reportFolder, fileName)

    logging.info('Writing to: {0}'.format(filePath))
    open(filePath, "w").write(str(report))
    logging.info('Done!')

def main():
    report = produceVXReport()

    if not report == None:
        writeReport(report)

    else:
        logging.error('Failed to produce report.')

if __name__ == "__main__":
    main()

